#ifndef _FASTAPARSER_H_
#define _FASTAPARSER_H_

#include "base/FileParser.h"
#include "analysis/DNAVector.h"

class FastaParser // parse fasta file and make available the names and sequences 
{
 public:
   FastaParser() {};
   
   void Open(string & file) {fileparse.Open(file);}
   int CountSeqs() {return m_numseqs;}
   string GetName(int n) {return m_names[n];}
   DNAVector GetSeq(int n) {
     DNAVector d;
     d.SetFromBases(m_seqs[n]);
     return d;
   }

   void Parse() {
       m_numseqs=0;
       string currentline;
       string currentseq;
       while(fileparse.GetLine(currentline)) {
	  if(currentline[0]=='>') {
              m_numseqs++;
	      currentline.erase(0,1);
	      m_names.push_back(currentline);
	      if(!currentseq.empty()) {
	          m_seqs.push_back(currentseq);
	          currentseq.clear();
		}  
	    } else currentseq.append(currentline);
	 }
       m_seqs.push_back(currentseq);	 
     }
 
 private:
   FlatFileParser fileparse;
   vec<string> m_names;
   vec<string> m_seqs;
   int m_numseqs;
};


#endif 
