// Copyright (c) 2005 Broad Institute/Massachusetts Institute of Technology




//#include "Arachne/MainTools.h"
//#include "Arachne/TaskTimer.h"
#include "util/QCMarkup.h"

QCMarkup::QCMarkup()
{
}

QCMarkup::~QCMarkup()
{
}

void QCMarkup::Sort()
{
  ::Sort(m_allMarks);

  int i;
  int lastSuper = -1;
  for (i=0; i<m_allMarks.isize(); i++) {
    int s = m_allMarks[i].GetSuper();
    if (s != lastSuper) {
      m_superMarkStart[s] = i;
    }

    m_superMarkStop[s] = i+1;
    lastSuper = s;
  }

}

void QCMarkup::SetNumSupers(int n)
{
  m_superLen.resize(n, 0);
  m_superMarkStart.resize(n, 0);
  m_superMarkStop.resize(n, 0);
}

void QCMarkup::AddMark(const QCMark & m)
{
  m_allMarks.push_back(m);
}

void QCMarkup::SetSuperNames(const svec<string> &s)
{
  m_superNames.clear();
  for (int i=0; i<s.isize(); i++)
    m_superNames.push_back(s[i]);
}

const string & QCMarkup::GetSuperName(int i) const 
{
  static const string empty;
  if (i < m_superNames.isize())
    return m_superNames[i];
  return empty;
}
